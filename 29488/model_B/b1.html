<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fruit Nutrition Comparator</title>
    <link
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <style>
      body.dark-mode {
        @apply bg-gray-900 text-white;
      }
      body.dark-mode .card {
        @apply bg-gray-800;
      }
    </style>
  </head>
  <body
    class="font-sans bg-white dark:bg-gray-900 transition-colors duration-300"
  >
    <header class="p-4 bg-blue-600 text-white dark:bg-gray-800">
      <h1 class="text-2xl">Fruit Nutrition Comparator</h1>
      <button
        id="themeToggle"
        class="mt-2 p-2 bg-gray-200 dark:bg-gray-700 text-black dark:text-white rounded"
      >
        Toggle Dark Mode
      </button>
    </header>
    <main class="container mx-auto p-4">
      <div class="flex flex-col md:flex-row justify-between mb-4">
        <select
          id="fruit1"
          class="p-2 m-2 rounded bg-gray-100 dark:bg-gray-700"
        ></select>
        <select
          id="fruit2"
          class="p-2 m-2 rounded bg-gray-100 dark:bg-gray-700"
        ></select>
      </div>
      <div id="charts" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
      <section id="healthBenefits" class="mt-8">
        <h2 class="text-xl mb-4">Fruits by Health Benefits</h2>
        <div
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"
          id="benefitCards"
        ></div>
      </section>
    </main>
    <script>
      const fruits = [
        // Example data, this should be populated from an API or JSON file
        { name: "Apple", vitaminC: 8, calories: 95, fiber: 4 },
        { name: "Banana", vitaminC: 10, calories: 105, potassium: 422 },
      ];

      const themeToggle = document.getElementById("themeToggle");
      const body = document.body;

      themeToggle.addEventListener("click", () => {
        body.classList.toggle("dark-mode");
        localStorage.setItem(
          "theme",
          body.classList.contains("dark-mode") ? "dark" : "light"
        );
      });

      if (localStorage.getItem("theme") === "dark") {
        body.classList.add("dark-mode");
      }

      function populateSelects() {
        const selects = [
          document.getElementById("fruit1"),
          document.getElementById("fruit2"),
        ];
        fruits.forEach((fruit) => {
          const option = document.createElement("option");
          option.value = fruit.name;
          option.textContent = fruit.name;
          selects.forEach((select) =>
            select.appendChild(option.cloneNode(true))
          );
        });
      }

      function createChart(fruit, containerId) {
        const ctx = document.getElementById(containerId).getContext("2d");
        new Chart(ctx, {
          type: "pie",
          data: {
            labels: ["Vitamin C", "Calories", "Fiber", "Potassium"],
            datasets: [
              {
                data: [
                  fruit.vitaminC,
                  fruit.calories,
                  fruit.fiber || 0,
                  fruit.potassium || 0,
                ],
                backgroundColor: ["#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0"],
              },
            ],
          },
        });
      }

      function updateCharts() {
        const f1 = document.getElementById("fruit1").value;
        const f2 = document.getElementById("fruit2").value;
        document.getElementById("charts").innerHTML = `
                <canvas id="chart1"></canvas>
                <canvas id="chart2"></canvas>
            `;
        createChart(
          fruits.find((f) => f.name === f1),
          "chart1"
        );
        createChart(
          fruits.find((f) => f.name === f2),
          "chart2"
        );
      }

      function displayHealthBenefits() {
        const benefits = {
          "Vitamin C": ["Apple", "Orange"],
          "High Fiber": ["Apple", "Pear"],
        };
        const container = document.getElementById("benefitCards");
        for (let [benefit, fruitList] of Object.entries(benefits)) {
          const card = document.createElement("div");
          card.className = "card p-4 rounded-lg shadow-lg";
          card.innerHTML = `<h3 class="text-lg">${benefit}</h3><ul>${fruitList
            .map((f) => `<li>${f}</li>`)
            .join("")}</ul>`;
          container.appendChild(card);
        }
      }

      populateSelects();
      document
        .getElementById("fruit1")
        .addEventListener("change", updateCharts);
      document
        .getElementById("fruit2")
        .addEventListener("change", updateCharts);
      updateCharts();
      displayHealthBenefits();
    </script>
  </body>
</html>
